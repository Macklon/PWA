<!DOCTYPE html>
<html>
<head>
	<title>COVID-19</title>
	<script src="/script.js"></script>
	<!-- CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

	<!-- JS, Popper.js, and jQuery -->
	<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

	<!-- Zing Chart cdn -->
    <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
    <!-- AJAX -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

	<!-- MANIFEST -->
	<link rel="manifest" href="/manifest.json">

	<!-- META TAGS -->
	<meta name="theme-color" content="black"/>
	<meta charset="utf-8"> 
	<meta name="mobile-web-app-capable" content="yes">
	<!-- <meta name="apple-mobile-web-app-capable" content="yes"> -->
	<meta name="application-name" content="COVID-19">
	<!-- <meta name="apple-mobile-web-app-title" content="COVID-19"> -->
	<meta name="msapplication-starturl" content="/index.html">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>
<body>
	<div class="container  mt-3">
		<!-- TITLE -->
		<h1 class="text-center">COVID-19</h1>
		<h3 class="text-center mb-5">Spread of Coronavirus in INDIA</h3>

		<!-- STATUS -->
		<div class="row">
				<div class="col-md-4">
					<div class="card text-center text-white  border-0">
					  	<div class="card-header bg-dark">
					  		<h5 class="card-title">INFECTED</h5>
					  	</div>
					  	<div class="card-body">
					    	<h3 class="card-title text-secondary">560</h3>
					  	</div>
					</div>
			</div>

				<div class="col-md-4">
					<div class="card text-center text-white  border-0">
					  	<div class="card-header bg-dark">
					  		<h5 class="card-title">DEATHS</h5>
					  	</div>
					  	<div class="card-body">
					    	<h3 class="card-title text-secondary">12</h3>
					  	</div>
					</div>
			</div>
				<div class="col-md-4">
					<div class="card text-center text-white  border-0">
					  	<div class="card-header bg-dark">
					  		<h5 class="card-title">CURED</h5>
					  	</div>
					  	<div class="card-body">
					    	<h3 class="card-title text-secondary">100</h3>
					  	</div>
					</div>
				</div>
		</div>

		<!-- BUTTONS -->
		<div class=" jumbotron row text-center">
		    <div class="col-md-4">
		      <button type="button" class="btn btn-secondary btn-lg">NEWS</button>
		    </div>
		    <div class="col-md-4">
		      <a href="prevention.html"><button type="button" class="btn btn-secondary btn-lg">PRECAUTIONS</button></a>
		    </div>
		    <div class="col-md-4">
		      <a href="help.html"><button type="button" class="btn btn-secondary btn-lg">HELPLINE NO.</button></a>
		    </div>
		</div>

		<!-- GRAPHS -->
		<div class="row">
		    <div class="col-6 border border-dark p-4">
		        <div class="" id="myPie"></div>
		    </div>
		    <div class="col-6 border border-dark p-4">
		        <div class="" id="myBar"></div>
		    </div>
		</div>
		<div class="row">
		    <div class="col-12 border border-dark p-4">
		        <div class="" id="myLine"></div>
		    </div>
		</div>
	</div>

 	<script>
        var state ={    
            'items':[],
            'values':[],
        }

        var dataURL = `catResults/`

        $.ajax({
            method:'GET',
            url:dataURL,
            success:function(response){
                console.log('RESPONSE:', response)
                for (var i in response){

                    var key = Object.keys(response[i])[0]
                    var value = Object.values(response[i])[0]

                    state.items.push(key)
                    state.values.push(value)
                }

                console.log('STATE:', state)
                buildChart()

            }
        })

        function buildChart(){
                var chartData = {
                  type: 'pie',
                  // backgroundColor: 'gray',
                  borderRadius: '5px',
                  plot: {
                    tooltip: {
                      rules: [
                        {
                          text: '%v People',
                          borderRadius: '4px',
                          rule: '%i == 0',
                          shadow: false
                        }
                      ]
                    },
                    valueBox: {
                        placement: 'out',
                        text: '%t\n%npv%',
                        fontFamily: "Open Sans"
                      },
                    animation: {
                      effect: 'ANIMATION_EXPAND_LEFT',
                      sequence: 'ANIMATION_BY_PLOT_AND_NODE'
                    },
                    refAngle: 270,
                    slice: '50%'
                  },
                  plotarea: {
                    margin: 'dynamic'
                  },
                  labels: [
                    {
                      text: 'Visitors Class',
                      // alpha: 0.7,
                      anchor: 'c',
                      fontColor: '#7E7E7E',
                      fontSize: '30px',
                      textAlign: 'center',
                      x: '50%',
                      y: '50%'
                    }
                  ],
                  series: [
                    {
                      values:[state.values[0]],
                      backgroundColor: 'orange',
                      borderWidth: '0px',
                      text: "Known People",
                      slice: 105
                    },
                    {
                      values:[state.values[1]],
                      text: "Unknown People",
                      backgroundColor: 'red',
                      borderWidth: '0px',
                      slice: 105
                    }
                  ]
 			}


            zingchart.render({
              id: "myPie",
              data: chartData,
            });
        }    
	</script>
    <script>
        var stateB ={    
            'items':[],
            'values':[],
        }

        var dataURL = `countResults/`

        $.ajax({
            method:'GET',
            url:dataURL,
            success:function(response){
                console.log('RESPONSE:', response)
                for (var i in response){

                    var key = Object.keys(response[i])[0]
                    var value = Object.values(response[i])[0]

                    stateB.items.push(key)
                    stateB.values.push(value)
                }

                console.log('STATE:', stateB)
                buildBarChart()

            }
        })

        function buildBarChart(){
                var chartData = {
                "type":"bar",
                "title": {
                    "text": "Visitor Count",
                    "font-size": "24px",
                    "font-color": "gray",
                    "adjust-layout":true
                },
                "plot": {   
                    "bars-space-left":0.15,
                    "bars-space-right":0.15,
                    "animation": {
                        "effect": "ANIMATION_SLIDE_BOTTOM",
                        "sequence": 0, 
                        "speed": 800,
                        "delay": 800
                    }
                },
                "scale-y": {
                    "line-color": "#7E7E7E",
                    "item": {
                        "font-color": "#7e7e7e"
                    },
                    "values": "0:10:1",
                    "guide": {
                        "visible": true
                    },
                    "label": {
                      "text": "No of Visitors Per day",
                      // "font-family": "arial",
                      "bold": true,
                      "font-size": "14px",
                      "font-color": "#7E7E7E",
                    },
                },
                "plotarea": {
                "margin": "dynamic"
            },
                "borderRadius": '5px',
                "scale-x":{
                    "values":stateB.items
                },
                "series":[
                    {
                        "values":stateB.values,
                        "background-color": "#FF4500",
                    }
                ]
            }


            zingchart.render({
              id: "myBar",
              data: chartData,
            });
        }    
	</script>
	<script>
        var stateL ={    
            'items':[],
            'values':[],
        }

        var objId = "1"

        var dataURL = `resultsAll/${objId}/`

        $.ajax({
            method:'GET',
            url:dataURL,
            success:function(response){
                console.log('RESPONSE:', response)
                for (var i in response){

                    var key = Object.keys(response[i])[0]
                    var value = Object.values(response[i])[0]

                    stateL.items.push(key)
                    stateL.values.push(value)
                }

                console.log('STATE:', stateL)
                buildLineChart()

            }
        })

        function buildLineChart(){
                var chartData = {
                "type":"line",
                "title": {
                    "text": "Visitors Activity",
                    "font-size": "24px",
                    "font-color": "gray",
                    "adjust-layout":true
                },
                "plotarea": {
                "margin": "dynamic 45 60 dynamic",
            },
                "borderRadius": '5px',
                "scale-x":{
                    "values":stateL.items
                },
                "series":[
                    {
                        "values":stateL.values,
                        "line-color": "#FF4500",
                    }
                ]
            }


            zingchart.render({
              id: "myLine",
              data: chartData,
            });
        }    
	</script>
</body>
</html>